<p style="text-align: center;"><img src=logo.png width="200" /></p>

<head> 
    <h2 style="text-align: center">Документация по Telegram Travel боту</h2>
</head>
<body>
<div class="release_info">
<hr>
<p><b>Автор:</b> Боровец Тимофей</p>
<p><b>Дата первой публикации:</b> 08 октября 2022 года</p>
<hr>
</div>

<div class="structure_project">

<h3>Структура файлов проекта:</h3>

<h5>В корневом каталоге лежит файл main.py из которого происходит запуск бота</h5>
<p>В файл импортируется переменная bot из файла bot.py каталога src, с помощью которой создается новый поток, что
позволяет боту автоматически получать обновления и соответствующим образом уведомлять слушателей и обработчиков 
сообщений.</p>

<h5>Остальные файлы находятся в каталоге src:</h5>

<ol>
<li><b>bot.py</b> — файл, из которого происходит обработка стандартных команд и сообщений от пользователя.
<p>В файле реализованы основные функции, которые используются при взаимодействии пользователя с ботом.</p>
<ul>
<li><b><i>start</i></b> — это функция, которая выполняется при активации бота.</li>
<li><b><i>hello_world</i></b> — это функция, которая обнуляет все данные пользователя и имитирует активацию бота.</li>
<li><b><i>helper</i></b> — функция, которая отправляет сообщение пользователю со списком команд, 
доступных для работы с ботом.</li>
<li><b><i>history</i></b> — функция, получает историю запросов пользователя из базы данных и отправляет ее пользователю.</li>
<li><b><i>get_text_messages</i></b> — функция, проверяет текст сообщения и вызывает соответствующую функцию.</li>
</ul>
</li>

<li><b>search.py</b> — файл хранит в себе весь процесс поиска необходимой информации и выдачи 
ее пользователю.
<p>В файле хранится обработка команд поиска полученных от пользователя и класс поиска информации с помощью API</p>
<ul>
<li>Классы:
<ul>
<li><b><i>GetInformation</i></b> — является классом для поиска необходимой информации независимо от способа сортировки
полученных данных от API</li>
</ul>
</li>
<li>Функции:
<ul>
<li><b><i>check_message</i></b> — функция, которая проверяет, не является ли сообщение командой. Например, пользователь передумал
продолжать поиск и решил начать другой, введя соответсвующую команду, тогда цепочка обработки информации прервется
и пользователь попадет в необходимое меню</li>
<li><b><i>low_price</i></b> — функция, которая вызывается, когда пользователь нажимает кнопку «Топ дешевых отелей» или вводит 
команду /low_price. Позволяет искать отели с сортировкой по Возрастанию цены.</li>
<li><b><i>high_price</i></b> — функция, которая вызывается, когда пользователь нажимает кнопку «Топ дорогих отелей» или 
вводит команду /high_price. Позволяет искать отели с сортировкой по Убыванию цены</li>
<li><b><i>best_deal</i></b> — которая вызывается, когда пользователь нажимает кнопку «Лучшее совпадение» или вводит команду 
/best_deal. Позволяет искать отели по расстоянию до центра города с сортировкой по Возрастанию цены на каждое 
расстояние.</li>
</ul>
</li>
</ul>
</li>

<li><b>history.py</b> — файл занимается обработкой истории запросов от пользователя(добавлением и выводом).
<p>Все функции завязаны на работе с data.json, в котором хранится вся история запросов.</p>
<ul>
<li><b><i>get_data</i></b> — стартовая функция при обработке истории данных, которая открывает json-файл и получает 
данные из него.</li>
<li><b><i>write_history</i></b> — финальная функция при обработке истории данных, которая сохраняет полученные данные в
json-файл.</li>
<li><b><i>add_search</i></b> — функция обрабатывает данные, полученные от метода get_data класса GetInformation в файле
search.py и добавляет эти данные для последующей записи в базу данных</li>
<li><b><i>get_history</i></b> — функция получает информацию из базы данных и передает ее функции history в файле main.py.
Таким образом данная функция является основной при запросе истории пользователем</li>
</ul>
</li>

<li><b>adjustment.py</b> — файл предназначен для обработки текста, полученного пользователем.
<p>Позволяет не заморачиваться с раскладкой клавиатуры пользователю при работе с ПК и переводит название городов при 
запросе информации.</p>
<ul>
<li><b><i>translit</i></b> — функция проверяет существование слова и если слово не существует, т.е. пользователь ввел
русское слово на английской раскладке("Ghbdtn" вместо "Привет"), данная функция вернет исправленное сообщение для 
последующей обработки команд с сохранением знаков пунктуации и регистров.</li>
<li><b><i>translate</i></b> — функция переводит название города на английский язык для поиска по API и 
текст результатов на русский язык .</li>
</ul>
</li>

<li><b>processing.py</b> — файл хранит в себе вспомогательные функции для работы основных стартовых команд.
<p>Чтобы код в main.py не был перегружен вспомогательные функции для взаимодействия с пользователем вынесены в отдельный
файл.</p>
<ul>
<li><b><i>add_id</i></b> — с запуском ботом происходит добавления идентификатора чата в базу данных для дальнейшего 
взаимодействия.</li>
<li><b><i>remove_id</i></b> — вызывается в тандеме с /hello_world и удаляет данные пользователя из базы данных</li>
<li><b><i>send_hello</i></b> — функция отправляет приветственное сообщение и предложение воспользоваться функционалом
данного бота</li>
<li><b><i>hello_user</i></b> — функция проверяет наличие чата и имени пользователя в базе данных, в случае отсутствия 
просит пользователя указать свое имя. Функция нечувствительна к регистру и раскладке и использует translit из 
adjustment.py для корректности имени</li>
<li><b><i>set_name</i></b> — добавляет указанное имя пользователем в базу данных, инициализирует словарь данных, 
который будет хранить историю запросов</li>
<li><b><i>preparing_search</i></b> — функция предваряет собой начало обработки запросов от пользователя и присылает 
все возможные способы для дальнейшего взаимодействия</li>
</ul>
</li>

<li><b>keys.py</b> — файл хранит в себе список всех текстовых клавиатур для упрощения взаимодействия пользователя с 
ботом.</li>

<li><b>data.json</b> — база данных, в которой первоначальным ключом к информации является идентификатор чата.</li>

<li><b>settings.ini</b> — файл конфигурации, который хранит в себе токены для API и URL запросов API Hotel.</li>
</ol>
</div>
<div class="about">

<h3 style="text-align: center">Реализация</h3>
<h4>
Данный бот реализует свой функционал с помощью двух API:
</h4>

<ol>
<li>
<a href="https://core.telegram.org/bots">API Telegram bots</a>
<p>Данный API является фундаментом для взаимодействия пользователя с ботом. Бот подключается к серверу, на котором 
расположен обработчик входных данных и запросов от пользователей через промежуточный сервер Telegram, связь с которым 
осуществляется через  HTTPS-интерфейс с упрощенной версией Telegram API – известной как Bot API.</p>
<p>Идентификация на сервере осуществляется за счет токена, который расположен в файле processing.py и передается 
в main.py через импорт данных.</p>
</li>

<li>
<a href="https://rapidapi.com/apidojo/api/hotels4">API Hotels</a>
<p>Данный API предназначен для реализации поисковых запросов полученных от пользователя. В процессе взаимодействия 
пользователя с ботом собирается необходимая информация для запроса к API, предоставляющего данные об отелях в указанном
городе. Весь процесс работы с данным API реализован в файле search.py</p>
</li>
</ol>
</div>
<hr>
<div class="important_info">
<h2 style="text-align: center">ВАЖНАЯ ИНФОРМАЦИЯ!</h2>
<h3 style="text-align: center">Бот не работает для поиска городов в Российской Федерации</h3>
<p style="text-align: center">Это связано с работой самого API Hotels. Изначально API умеет находить только ограниченное
количество отелей в городе РФ, но не предоставляет детальной информации о данном отеле. Учитывайте данную информацию 
при работе с данным Телеграм Travel ботом.</p>
<hr>
<div class="footer">
<h3>Благодарности:</h3>
<ul>
<li style="font-size: 14px"><b>Харламову Александру</b> - куратору в модуле «Python Basic»</li>
<li style="font-size: 14px">Службе заботы и всей команде Skillbox</li>
</ul>
</div>
</div>
</body>